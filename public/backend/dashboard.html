<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>HIVE - Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="../assets/css/style.css" />
    <script src="../assets/js/main.js"></script>

    <!--bootstrap--> 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
   
     <!--font awsome-->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--favicon-->
    <link rel="shortcut icon" href="../assets/images/favicon.png">
<script>
$(document).ready(function(){
  
 
var user = localStorage.getItem("user");
alert(user);

  //get user data

  var url = "https://hiveapp.mybluemix.net/patientInfo/";
  var userID = '<%-JSON.stringify(patientID) %>'; 
  var userUrl = url.concat(userID);

  $.getJSON(userUrl, function(userdata){

    $.each(userdata, function(index, element) {
      $('#user-fname').append('Welcome <span class="text-uppercase">'+element.firstname+'</span');
      $('#userID').append('Patient ID: '+element.patientID);
    });
  }); 

  //get booking data

 
  var url = "https://hiveapp.mybluemix.net/bookingData/";
  var patientID = '<%-JSON.stringify(patientID) %>'; 
  var patientUrl = url.concat(patientID);

  $.getJSON(patientUrl, function(bookdata){

    $.each(bookdata, function(bookindex, element) {
      
      var booktypename="";
      var booktype=element.bookingType;
      
      if(booktype==1){
        booktypename="Standard";
      }
      else if(booktype==2){
        booktypename="Long";
      }
      else{
        booktypename="Special";
      }
      
      //
      var docID=element.doctorID;
      var str1 = "https://hiveapp.mybluemix.net/doctorInfo/";
      var str2=docID.toString();
      var url = str1.concat(str2);
      
      $.getJSON(url, function(data){

        $.each(data, function(index, elem) {

          $('tbody').append('<tr><td>'+element.bookingID+'</td><td>'+booktypename+'</td><td>'+element.bookingDatetime+'</td><td>'+element.bookingNote+'</td><td>'+elem.firstname+' '+elem.lastname+'</td><td><button class="btn btn-sm btn-warning paynow-btn" onclick="setbookingID('+element.bookingID+')"; ><a href="payment.html">Pay Now</a></button></td></td><td><button class="btn btn-primary btn-sm" id="joinchat-btn" disabled>Join Chat</button></td></tr>');

        }); 

      }); 

      //
    });
    
  }); 

//get doctor list

  $.getJSON("https://hiveapp.mybluemix.net/doctorList", function(data){

  $.each(data, function(index, element) {

    
    var pID = '<%-JSON.stringify(patientID) %>'; 
  
  $('ul').append('<li class="row"><div class="col-lg-8 col-md-8">'+element.firstname+' '+element.lastname+'</div><form class="col-md-4 col-lg-4" action="/booking" method="GET"><input type="submit" value="book" class="btn btn-sm btn-primary" onclick="setID('+element.doctorID+','+pID+')"/></form></li>');

});

});

});
 
 
</script>
</head>

<body>
    <div class="row">
        <div class="dash-column-left col-lg-3 col-md-3">
            <div class="head"></div>
            <div class="head"></div>
            <div class="logo">
              <a href="#">
                <img src="../assets/images/logo.png">
              </a>
            </div>
            <div class="user-info">
                <h4 class="user-fname" id="user-fname"></h4>
                <div id="userID"></div>
            </div>
              <ul class="doctor-list">
                  <h4>Available Doctors</h4>
              </ul>
        </div>
        <!--end of left column -->
        <div class="dash-column-right col-md-9 col-lg-9">
            <h2 class="heading">My Bookings</h2>
              <table class="table table-bordered table-striped booking-table" id="booking-table">
                
                <thead>
                    <th>Booking ID</th><th>Booking Type</th><th>TimeDate (HHMMDDMMYYYY)</th><th>Booking Note</th><th>Doctor</th><th></th><th></th></tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>     
    </div>
     

        
</body>
</html>


		
   
	
 
	
